alert udp $EXTERNAL_NET 137 -> $HOME_NET 137 (msg: "ATTACK [PTsecurity] BadTunnel NBNS response after NBSTAT query"; flow: no_stream; byte_test: 1,&,0x80,2; content: !"|00 00|"; offset: 6; depth: 2; threshold: type limit, track by_dst, count 1, seconds 30; xbits:isset,BadTunnelStage1,track ip_dst; reference: url, xlab.tencent.com/en/2016/06/17/BadTunnel-A-New-Hope/; reference: cve, 2016-3236; classtype: attempted-recon; reference: url, github.com/ptresearch/AttackDetection; sid: 10000051; rev:2;)

#alert udp $EXTERNAL_NET 137 -> $HOME_NET 137 (msg: "ATTACK [PTsecurity] BadTunnel WPAD spoofing attempt via NBNS"; flow: no_stream; content: "|46 48 46 41 45 42 45 45|"; offset: 13; depth: 8; threshold: type limit, track by_dst, count 1, seconds 30; reference: url, xlab.tencent.com/en/2016/06/17/BadTunnel-A-New-Hope/; reference: cve, 2016-3236; classtype: attempted-recon; reference: url, github.com/ptresearch/AttackDetection; sid: 10000052; rev:1;)

#alert udp $EXTERNAL_NET 137 -> $HOME_NET 137 (msg: "ATTACK [PTsecurity] BadTunnel ISATAP spoofing attempt via NBNS"; flow: no_stream; content: "|45 4A 46 44 45 42 46 45 45 42 46 41|"; offset: 13; depth: 12; threshold: type limit, track by_dst, count 1, seconds 30; reference: url, xlab.tencent.com/en/2016/06/17/BadTunnel-A-New-Hope/; reference: cve, 2016-3236; classtype: attempted-recon; reference: url, github.com/ptresearch/AttackDetection; sid: 10000053; rev:1;)

